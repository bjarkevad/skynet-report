\documentclass[Main]{subfiles}
\begin{document}

\subsection{Planning procedure}

The proposed planning procedure for a multi-agent system can be divided in to "??????? four ????????" algorithms. The first being the distribution of goals between agents, done with a bidding algorithm. 
The \textit{bidding algorithm} utilizes simple heuristics consisting of the Manhattan distance between an agent and box, and box and goal, with a slight favoring of as few box moves as possible. All agents in the level will bid on all goals, that it is eligible for solving, and it will do so for all boxes that can solve the goal. After a round of bidding, the smallest bid, in terms of heuristics, is evaluated in order to determine if it is possible for the agent to fulfill the bid. The evaluation is done as a relaxed problem search. 



- If not feasible - next bid
- If agent is "overburdened" - next bid
- If box is used

The \textit{relaxed problem search} regards the level with only one agent, one goal and one box that can possibly solve the goal. The search is done with A^{*} strategy. 

The relaxed problem search also functions as a sort of ``all goals shortest path'' calculation. It is however, not the shortest paths for all goals, but while it might be for some, it shows a possible path for all goals. 


\textit{Other advantages of relaxed problem search}



\cite{BIDDING - SOMETHING from bjarke}






\subsection{POP}
Partial order planning can be said to occur twice in the planning procedure, as the procedure consists of two major parts. The first part is a sort of ``all goals shortest path'' calculation as well as a determination of goal ordering / prioritizing. 
It is done as a relaxed problem search where the only components regarded are the goal to be solved, a box to solve it with, the agent to move the box, and the walls of the level. The relaxed problem is solved utilizing A^{*} search strategy. 





\subsubsection{Heuristics}

\textbf{Partial order plan heuristics}


\textbf{############## Heuristics}






- Relaxed problem --> Only one goal, box and agents

- Picking a specific box for a goal
- Relies heavily on the goal order being correct and chosen boxes being correct



\todo[inline]{Plan repair}
\todo[inline]{Tie breaking}


\subsection{Multi-agent} 

The implementation of the multi agent client  .... 



The goals are ordered with regards to whether or not they disrupt or conflict with other subgoal plans \autoref{sect:subgoal_pop}. As the planning is executed sequentially in the determined goal order, and not concurrently, the communication between agents and determination of ``who is right'' can be simplified. 
If an agent moves a box or occupies a cell at a given time, it is the other agents responsibility to comply with this and either wait or do something else. However, this practice relies on that the determined goal order is correct possible to complete. 

The communication is simply done by letting the agents announce which cells they occupy at a given time in the plan as well as which box they move, if any. 



\textbf{Shortcomings}
- Bidding - if box is taken. At least one case where it CAN fail

The bidding and choosing of boxes for solving goals has one dire weakness, that without re-planning, will leave the client unable to solve the level. As the heuristics used for bidding favors boxes that are close to the goals, 
\begin{verbatim}
+++++++++
+AAAAAAA++++++++
++++++0 aaaaaaa+
++++++++++++++++
\end{verbatim}


\end{document}
